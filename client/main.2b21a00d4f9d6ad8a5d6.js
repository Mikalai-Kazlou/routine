!function(){"use strict";var t={91:function(t){t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),e.hash&&(t+=e.hash),e.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(t)?'"'.concat(t,'"'):t):t}},215:function(t,e,n){t.exports=n.p+"assets/routine-favicon.png"},302:function(t,e,n){t.exports=n.p+"assets/rs_school.svg"}},e={};function n(s){var i=e[s];if(void 0!==i)return i.exports;var a=e[s]={exports:{}};return t[s](a,a.exports,n),a.exports}n.m=t,n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var s in e)n.o(e,s)&&!n.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var s=e.getElementsByTagName("script");s.length&&(t=s[s.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t}(),n.b=document.baseURI||self.location.href,function(){var t,e=n(91),s=n.n(e),i=new URL(n(215),n.b),a=new URL(n(302),n.b);s()(i),s()(a),n.p,n.p,function(t){t[t.monday=0]="monday",t[t.tuesday=1]="tuesday",t[t.wednesday=2]="wednesday",t[t.thursday=3]="thursday",t[t.friday=4]="friday",t[t.saturday=5]="saturday",t[t.sunday=6]="sunday"}(t||(t={}));var o=t;function r(t,e=document){const n=e.querySelector(t);if(null===n)throw new Error("Ups! This element is not found!");return n}function l(t,e=document){return r(`.${t}`,e)}const d=(t,e)=>{const n=document.createElement(t);return n.classList.add(e),n};function c(t,e){const n=document.createElement(t);return n.classList.add(e),n}const u={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight};function h(...t){t.forEach((t=>{t.disabled=!1}))}function p(...t){t.forEach((t=>{t.disabled=!0}))}function m(t){return t.sort(((t,e)=>t.duration>e.duration?-1:1))}function g(t){if(t<60&&t>=0)return`${t} min`;if(t>=60)return t%60==0?`${Math.floor(t/60)} h`:`${Math.floor(t/60)}:${(t%60).toString().padStart(2,"0")} h`;throw new Error("Wrong value in minToHour fn")}function _(t,e){console.log(t instanceof Error),t instanceof Error&&"401"===t.message&&e("/login")}function v(t){for(let e=0;e<7;e+=1){const n=e.toString();if(o[e]===t.substring(1))return n}return""}var f=class{static async registration(t){return console.log(this.name),this.post(t,"/users/registration")}static async login(t){return this.post(t,"/users/login")}static async getWeekDistribution(){return this.get(!1,"/weekDistribution","/get")}static async deletePlan(t){return this.delete(t,"/plans")}static async getAllPlans(){return this.get(!1,"/plans")}static async createNewPlan(t){return this.post(t,"/plans")}static async editPlan(t){return this.post(t,"/plans","/update")}static async pushPlanToDay(t){return console.log(t),this.post(t,"/weekDistribution","/adjustPlan")}static async getDayDistribution(t){return this.get(t,"/dayDistribution","/get")}static async get(t,...e){let n=`https://warm-bayou-30321.herokuapp.com/api${e.join("")}`;t&&(n=`${n}/${t}`);const s=await fetch(n,{method:"GET",credentials:"include"}),i=await s.json();if(!s.ok)throw new Error(s.status.toString());return i}static async post(t,...e){const n={method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)},s=await fetch(`https://warm-bayou-30321.herokuapp.com/api${e.join("")}`,n),i=await s.json();if(console.log(s.ok),!s.ok)throw new Error(s.status.toString());return i}static async delete(t,...e){const n=await fetch(`https://warm-bayou-30321.herokuapp.com/api${e.join("")}/${t}`,{method:"DELETE",credentials:"include"}),s=await n.json();if(console.log(s),!n.ok)throw new Error(n.status.toString());return s}},y=new Map([["#9F5454","#e3e3e3"],["#FFC0CB","#505050"],["#98FF98","#505050"],["#E6E6FA","#505050"],["#FFE5B4","#505050"],["#d4466c","#e3e3e3"],["#D3D3D3","#505050"],["#808000","#e3e3e3"],["#FA8072","#e3e3e3"],["#9DC183","#505050"],["#C8A2C8","#505050"],["#549F7B","#e3e3e3"],["#ffc800","#505050"],["#4682B4","#e3e3e3"],["#9370DB","#e3e3e3"],["#00FFFF","#505050"],["#800000","#e3e3e3"],["#A9A9A9","#505050"],["#FF1493","#e3e3e3"],["#F0E68C","#505050"],["#A020F0","#e3e3e3"],["#1E90FF","#e3e3e3"],["#89CFF0","#505050"],["#FFA500","#505050"]]),w=["flex-start","flex-end","center"],T=class{constructor(t){this.planInfo=t,this.width=0,this.blur=c("div","plan-round__blur")}getUniqValue(){return parseInt(this.planInfo.color.slice(6,7),16)+parseInt(this.planInfo.color.slice(4,5),16)}getFontSize(){return this.width/5.5+"px"}getBlurHeight(t){return t/this.planInfo.duration*this.width+"px"}getValueSize(){return this.width/20+8+"px"}paintRound(t){this.blur.style.height=this.getBlurHeight(t)}setWidth(t){let e=(t-70)*(this.planInfo.duration/1425)+70;e<70&&(e=70),e>t&&(e=t),this.width=e}draw(){const t=document.createElement("div"),e=document.createElement("span"),n=document.createElement("span");t.setAttribute("draggable","true"),t.setAttribute("data-plan-id",this.planInfo._id),t.classList.add("plan-round","button"),n.classList.add("plan-round__value"),t.style.backgroundColor=this.planInfo.color,e.innerText=this.planInfo.title,e.style.fontSize=this.getFontSize(),n.innerText=g(this.planInfo.duration),n.style.fontSize=this.getValueSize(),t.style.width=`${this.width}px`,t.style.height=t.style.width;const s=this.getUniqValue();t.style.margin=`${s}px`,t.style.alignSelf=`${w[s%w.length]}`;const i=y.get(this.planInfo.color);return i&&(t.style.color=i,n.style.color=i+128..toString(16)),t.append(e,n,this.blur),t}},L=class{constructor(t,e,n){this.name=t,this.goTo=e,this.editor=n,this.dayId=""}async getFilledPage(){const t=document.createElement("h1");return t.innerText=this.name,t}async animatedFilledPageAppend(t){t.classList.add("main__container_hide");const e=await this.getFilledPage();t.innerHTML="",t.classList.remove("main__container_hide"),t.append(e)}async draw(t){t&&(this.dayId=t);const e=l("main__container");await this.animatedFilledPageAppend(e)}},k=class{constructor(t){this.goTo=t}makeNavButton(t,e,n){const s=c("button","nav-button");return s.innerText=t,s.addEventListener("click",(()=>n(e))),s}makeWeekLine(){const t=document.createElement("div");return t.classList.add("plan__week-line"),t}makeInfoText(t){const e=c("div","plan__text-container"),n=c("div","plan__text-value"),s=c("div","plan__text-value");return s.innerText=t,e.append(n,s),e}createDay(t){const e=document.createElement("div");e.classList.add("plan__day"),e.setAttribute("data-day-id",t.toString());const n=document.createElement("div");n.classList.add("plan__day-line");const s=document.createElement("div");s.classList.add("plan__day-name"),s.innerHTML=o[t].slice(0,3);const i=document.createElement("div");return i.classList.add("plan__day-hours"),e.append(n,s,i),e.addEventListener("click",(()=>this.goTo(`/${o[t]}`))),e}fillPlanDaysContainer(t){const e=t;for(let t=0;t<7;t+=1)e.append(this.createDay(t));return e}makeAddButton(){const t=document.createElement("button");t.classList.add("button","plan__button-add");const e=document.createElement("span");e.innerText="+",e.classList.add("plan__button-add-name");const n=document.createElement("span");return n.classList.add("plan__button-add-value"),t.append(e,n),t}makeReturnToWeekZone(t,e){const n=c("div","day-page__return"),s=document.createElement("div");return s.style.backgroundImage="url('./assets/svg/return.svg')",n.append(s),this.addReturnListeners(n,t,e),n}addReturnListeners(t,e,n){t.addEventListener("dragover",(function(t){t.preventDefault(),this.classList.add("day-page__return_over")})),t.addEventListener("dragleave",(function(){this.classList.remove("day-page__return_over")})),t.addEventListener("drop",(async t=>{t.stopPropagation(),t.preventDefault();const{currentTarget:s}=t;s instanceof HTMLElement&&s.classList.remove("day-page__return_over");const i=l("plan-round_drag"),a=i.dataset.planId;if(!a)throw new Error("no id");const r=n.filter((t=>t._id===a))[0].duration,d={dayOfWeek:Number(e),planId:a,duration:-r};if(a)try{i.style.visibility="hidden",l("main__container").classList.add("main__container_hide"),await f.pushPlanToDay(d),this.goTo(`/${o[Number(e)]}`)}catch(t){_(t,this.goTo)}}))}makeRemoveZone(){const t=c("div","plan__remove"),e=document.createElement("div");return e.style.backgroundImage="url('./assets/svg/bin.svg')",t.append(e),t.addEventListener("dragover",(function(t){t.preventDefault(),this.classList.add("plan__remove_over")})),t.addEventListener("dragleave",(function(){this.classList.remove("plan__remove_over")})),t.addEventListener("drop",(async t=>{t.stopPropagation(),t.preventDefault();const{currentTarget:e}=t;e instanceof HTMLElement&&e.classList.remove("plan__remove_over");const n=l("plan-round_drag"),s=n.dataset.planId;if(s)try{n.style.display="none",l("main__container").classList.add("main__container_hide"),await f.deletePlan(s),this.goTo("/plan")}catch(t){_(t,this.goTo)}})),t}makeBanner(t){const e=document.createElement("h2");return e.classList.add("banner"),e.innerText=t,e}makePlanBody(){const t=document.createElement("div");t.classList.add("plan__body"),document.createElement("div").classList.add("plan__tools");const e=document.createElement("div");e.classList.add("plan__field");const n=document.createElement("div");n.classList.add("plan__buttons");const s=document.createElement("div");s.classList.add("weekend-fields");const i=document.createElement("div");i.classList.add("weekend-fields__big");const a=document.createElement("div");a.classList.add("weekend-fields__small");const o=document.createElement("div"),r=this.fillPlanDaysContainer(o);return r.classList.add("plan__days"),n.append(this.makeAddButton(),this.makeRemoveZone()),s.append(i,a),e.append(n,s),t.append(r,e),t}makeButtonsBlock(){const t=c("div","day-page__nav-buttons");return t.append(this.makeNavButton("Home","/",this.goTo),this.makeNavButton("Week","/plan",this.goTo)),t}createPlanListItem(t){const e=c("li","plan-list__item"),n=c("div","plan-list__color");n.style.backgroundColor=t.color,n.style.width=200*t.duration/1440*2+"px";const s=c("span","plan-list__name");s.innerText=t.title;const i=c("span","plan-list__dur");return i.innerText=`( ${g(t.duration)} )`,e.append(n,s,i),e}fillPlanList(t,e){const n=t;return e.forEach((t=>{n.append(this.createPlanListItem(t))})),n}makeDayBody(t,e){const n=c("div","day-page__body"),s=c("div","day-page__info"),i=c("div","day-page__field"),a=c("div","day-page__tools"),r=c("div","day-page__plans-zone"),l=c("h2","day-page__name");l.innerText=o[Number(t)].toUpperCase();const d=c("ul","plan-list");return this.fillPlanList(d,e),a.append(this.makeReturnToWeekZone(t,e),this.makeAddButton()),i.append(a,r),s.append(l,d),n.append(s,i),n}},b=class extends L{constructor(t,e,n){super("Day page",t,n),this.distPlans=[],this.notDistPlans=[],this.allDayPlans=[],this.allWeekPlans=[],this.weekDistribution=[],this.allPlansDist={},this.planRounds=[],this.popup=e,this.layout=new k(t),this.timeLine=new class{draw(){return c("div","timeline")}}}makePlans(){this.planRounds=[],this.planRounds=this.notDistPlans.map((t=>new T(t)))}showElements(){const t="scale(1)";setTimeout((()=>{l("plan__button-add").style.transform=t,l("day-page__return").style.transform=t,document.querySelectorAll(".plan-list__color").forEach((e=>{e instanceof HTMLDivElement&&(e.style.transform=t)})),document.querySelectorAll(".plan-round").forEach((e=>{e instanceof HTMLDivElement&&(e.style.transform=t)}))}),0)}getDayDistTime(){return this.allDayPlans.reduce(((t,e)=>t+e.duration),0)}setAddButton(){l("plan__button-add").addEventListener("click",(()=>{this.popup.editorMode();const t=1440-this.getDayDistTime();if(t<15)return void this.popup.open(this.layout.makeBanner("Less than 15 minutes left\n\n Free up your DAY time"));const e=10080-this.getFilledWeekTime();e<15?this.popup.open(this.layout.makeBanner("Less than 15 minutes left\n\n Free up your WEEK time")):this.editor.open(15,Math.min(e,t),4,void 0,this.dayId)}))}getFilledWeekTime(){return this.allWeekPlans.reduce(((t,e)=>t+e.duration),0)}fillTextInfo(){const t=this.getDayDistTime();l("plan__text-value").innerText=g(t),l("plan__button-add-value").innerText=g(1440-t)}fillPlansZone(){const t=l("day-page__plans-zone"),e=.4*t.clientWidth;this.planRounds.forEach((n=>{n.setWidth(e);const s=n.draw(),i=this.getDayPlanDistTime(n);n.paintRound(i),this.setRoundClick(s,i,n),this.setRoundMove(s),t.append(s)}))}setRoundMove(t){const e=l("day-page__return");t.addEventListener("dragstart",(function(){setTimeout((()=>{this.classList.add("plan-round_drag"),e.classList.add("plan__remove_drag"),e.style.transform="scale(1.45)"}),50)})),t.addEventListener("dragend",(function(){this.classList.remove("plan-round_drag"),e.classList.remove("plan__remove_drag"),e.style.transform="scale(1)"}))}setRoundClick(t,e,n){const s=this.allWeekPlans.filter((t=>t._id===n.planInfo._id))[0].duration,i=e,a=n.planInfo.duration+Math.min(s-this.allPlansDist[n.planInfo._id],1440-this.getDayDistTime());t.addEventListener("click",(()=>this.editor.open(i,a,3,n.planInfo,this.dayId)))}setPlanDistTime(){const t=this.weekDistribution.flat();this.allPlansDist=t.reduce(((t,e)=>(t[e._id]?t[e._id]+=e.duration:t[e._id]=e.duration,t)),{})}getDayPlanDistTime(t){return t.planInfo.duration-this.notDistPlans.filter((e=>e._id===t.planInfo._id))[0].duration}async setDayInfo(){const t=await Promise.all([f.getDayDistribution(this.dayId),f.getWeekDistribution(),f.getAllPlans()]),[e,n,s]=t,{distributedPlans:i,notDistributedPlans:a}=e;this.allDayPlans=m(n[Number(this.dayId)]),this.weekDistribution=n,this.allWeekPlans=s,this.distPlans=i,this.notDistPlans=a}async getFilledPage(){await this.setDayInfo(),this.setPlanDistTime(),this.makePlans();const t=c("div","day-page__container");return t.append(this.layout.makeButtonsBlock(),this.layout.makeInfoText(" / 24 h"),this.timeLine.draw(),this.layout.makeDayBody(this.dayId,this.allDayPlans)),t}async draw(t){this.dayId=t;try{const t=l("main__container");await this.animatedFilledPageAppend(t),this.fillTextInfo(),this.fillPlansZone(),this.setAddButton(),this.showElements()}catch(t){this.goTo("/login")}}},E=[{title:"Job",list:["do something","do something else","be cool","do something else","be cool"],text:"Lorem ipsum dolor, sit amet consectetur adipisicing elit. Dolorum ipsum dolorem consequatur, impedit iusto aut adipisci excepturi nemo quam laborum earum ratione iure explicabo, sapiente sint minus exercitationem iste placeat."},{title:"English",list:["do something","do something else","be cool"],text:"Ipsum dolor, sit amet consectetur adipisicing elit. Dolorum ipsum dolorem consequatur, impedit iusto aut adipisci excepturi nemo quam laborum earum ratione iure explicabo, sapiente sint minus exercitationem iste placeat."},{title:"Family",list:["do something","do something else","be cool"],text:"Dolor, sit amet consectetur adipisicing elit. Dolorum ipsum dolorem consequatur, impedit iusto aut adipisci excepturi nemo quam laborum earum ratione iure explicabo, sapiente sint minus exercitationem iste placeat."},{title:"Person time",list:["do something","do something else","be cool"],text:"Sit amet consectetur adipisicing elit. Dolorum ipsum dolorem consequatur, impedit iusto aut adipisci excepturi nemo quam laborum earum ratione iure explicabo, sapiente sint minus exercitationem iste placeat."},{title:"Dog",list:["do something","do something else","be cool"],text:"Amet consectetur adipisicing elit. Dolorum ipsum dolorem consequatur, impedit iusto aut adipisci excepturi nemo quam laborum earum ratione iure explicabo, sapiente sint minus exercitationem iste placeat."}],x=[{id:1,hours:6,color:"#9F5454"},{id:2,hours:1.5,color:"#549F7B"},{id:3,hours:2,color:"#9F5481"},{id:4,hours:1.5,color:"#54729F"},{id:5,hours:1,color:"#9b9b9b"}],P=[{id:"63dab20a1bad4d34504b5c18",title:"Do gym every morning"},{id:"63dab20a1bad4d34504b5c19",title:"Buy a quadcopter"},{id:"63dab20a1bad4d34504b5c16",title:"Buy a car"},{id:"63dab20a1bad4d34504b5c15",title:"Buy a house"}],I=class{constructor(t){this.thoughtText=t}createThought(t,e){console.log(t,e)}openCloseThought(t,e){t.target instanceof EventTarget&&(t.target.closest(".open")?e.classList.remove("open"):e.classList.add("open"))}draw(t){const e=d("div",t),n=d("div","thought__add-btn");e.classList.add("none");const s=c("input","thought__input");s.value=this.thoughtText,s.addEventListener("blur",(()=>{s.value&&(this.thoughtText=s.value)}));const i=c("div","thought__create-btn");return i.addEventListener("click",(t=>{this.createThought(this.thoughtText,t)})),n.addEventListener("click",(t=>this.openCloseThought(t,e))),e.append(s,i,n),e}},D=class extends I{constructor(t){super(t),this.thoughtText=t}createThought(t){t&&(P.push({id:"63dab20a1bad4d34504b5c10",title:t}),this.createThoughtsList(r(".thought__container")),console.log("create:",t),this.thoughtText="",r(".thought__input").value=this.thoughtText)}createThoughtsList(t){const e=t;e.innerHTML="";const n=[];P.forEach((t=>{n.push(new I(t.title))}));for(let t=0;t<n.length;t+=1){const s=n[t].draw("thought__item");e.append(s)}}},M=class extends L{constructor(t,e){super("Home page",t,e),this.toDoInst=new class{draw(t){const e=d("div","to-do__title");e.textContent=E[t].title;const n=d("textarea","to-do__textarea");return n.textContent=E[t].text,e.append(n),e}},this.clockInst=new class{getIcon(t){const e=t.getHours();return r(".chart"),e>=6&&e<12?"url('./assets/svg/sun-up.svg')":e>=12&&e<18?"url('./assets/svg/sun.svg')":e>=18&&e<24?"url('./assets/svg/sun-down.svg')":"url('./assets/svg/moon.svg')"}getDay(t){const e=new Intl.DateTimeFormat("en",{weekday:"short",month:"long",day:"numeric"}).format(t).replace(",","").split(" ");return`\n    <div class="day-info__date">${e[2]}</div>\n    <div class="day-info__wrapper">\n      <div class="day-info__day">${e[0]}</div>\n      <div class="day-info__month">${e[1]}</div>\n    </div>`}getTime(){const t=r(".hour__circle"),e=r(".minutes__circle"),n=d("div","day-info"),s=d("div","day-info__icon");setInterval((()=>{const i=new Date,a=30*i.getHours(),o=6*i.getMinutes();n.innerHTML=this.getDay(i),s.style.backgroundImage=this.getIcon(i),n.prepend(s),r(".chart").append(n),t.style.transform=`rotateZ(${a+o/12}deg)`,e.style.transform=`rotateZ(${o}deg)`}),1e3)}},this.chartInst=new class{createSvgElement(t,e){const n=document.createElementNS("http://www.w3.org/2000/svg",t);return Object.entries(e).forEach((([t,e])=>n.setAttributeNS(null,t,e))),n}createChart(t,e,n){const{strokeWidth:s,radius:i}=n,a=i-s/2,o=2*i,r=2*Math.PI*a,l=[];e.forEach(((t,e)=>{const n=r*t.hours/12;let s=.25*r;if(e>0){const t=l[e-1];s=t.offset-t.width}l.push({...t,width:n,offset:s})}));const d=this.createSvgElement("svg",{viewBox:`0 0 ${o} ${o}`,fill:"none",width:o,height:o});l.forEach((t=>{const e=this.createSvgElement("circle",{id:t.id,cx:a+s/2,cy:a+s/2,r:a,"stroke-dasharray":`${t.width} ${r-t.width}`,"stroke-dashoffset":t.offset.toString(),stroke:t.color,"stroke-width":s});d.append(e)})),t.append(d)}}}showToDo(t){if(!(t.target instanceof SVGCircleElement&&t.target.id))return;const e=r(".to-do"),n=t.target.getAttribute("stroke");n&&(e.style.backgroundColor=n),e.innerHTML="";const s=this.toDoInst.draw(+t.target.id-1);e.append(s)}showCurrToDo(t){if(!(t.target instanceof SVGCircleElement&&t.target.id))return;const e=r(".to-do");e.style.backgroundColor="",e.innerHTML="";const n=this.toDoInst.draw(0);e.append(n)}createFlyingThought(){const t=c("canvas","canvas"),e=t.getContext("2d");t.width=u.width,t.height=u.height;const n=[];if(P.forEach((t=>{const{id:e}=t,s=Math.random()*(u.width-40)+20,i=Math.random()*(u.height-40)+20,a=2*(Math.random()-.5),o=2*(Math.random()-.5);n.push(new class{constructor(t,e,n,s,i,a){this.id=t,this.radius=a,this.x=e,this.y=n,this.dx=s,this.dy=i}draw(t){t.beginPath(),t.arc(Math.round(this.x),Math.round(this.y),this.radius,0,2*Math.PI),t.fillStyle="#999999",t.fill(),t.closePath(),this.updateThoughtPos()}updateThoughtPos(){(this.x+this.radius>u.width||this.x-this.radius<0)&&(this.dx=-this.dx),(this.y+this.radius>u.height||this.y-this.radius<0)&&(this.dy=-this.dy),this.x+=this.dx,this.y+=this.dy}getDistance(t,e){return Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2)}thoughtCollision(t){for(let e=0;e<t.length-1;e+=1)for(let n=e+1;n<t.length;n+=1){const s=t[e],i=t[n];if(this.getDistance(s,i)<=s.radius+i.radius){const t=s.angle(),e=i.angle(),n=Math.atan2(i.y-s.y,i.x-s.x),a=s.speed(),o=i.speed(),r=o*Math.cos(e-n)*Math.cos(n)+a*Math.sin(t-n)*Math.cos(n+Math.PI/2),l=o*Math.cos(e-n)*Math.sin(n)+a*Math.sin(t-n)*Math.sin(n+Math.PI/2),d=a*Math.cos(t-n)*Math.cos(n)+o*Math.sin(e-n)*Math.cos(n+Math.PI/2),c=a*Math.cos(t-n)*Math.sin(n)+o*Math.sin(e-n)*Math.sin(n+Math.PI/2);s.dx=r,s.dy=l,i.dx=d,i.dy=c,this.staticCollision(s,i)}}}staticCollision(t,e,n=!1){const s=t.radius+e.radius-this.getDistance(t,e),i=t,a=Math.atan2(e.y-t.y,e.x-t.x);i.x-=s*Math.cos(a),i.y-=s*Math.sin(a),this.getDistance(t,e)<t.radius+e.radius&&!n&&this.staticCollision(t,e,!0)}speed(){return Math.sqrt(this.dx*this.dx+this.dy*this.dy)}angle(){return Math.atan2(this.dy,this.dx)}}(e,s,i,a,o,20))})),e){const t=()=>{requestAnimationFrame(t),e.clearRect(0,0,u.width,u.height);for(let t=0;t<n.length;t+=1)n[t].draw(e),n[t].thoughtCollision(n)};t()}return t}createThoughtsList(t){const e=[];P.forEach((t=>{e.push(new I(t.title))}));for(let n=0;n<e.length;n+=1){const s=e[n].draw("thought__item");t.append(s)}}createThought(){const t=d("div","thought"),e=d("div","thought__container"),n=d("h3","thought__title");n.textContent="Thought";const s=new D("").draw("thought__add");s.classList.remove("none"),t.append(n,s,e),this.createThoughtsList(e);const i=c("div","blur");return i.classList.add("none"),document.body.append(i),n.addEventListener("click",(()=>{r(".canvas").classList.toggle("none"),s.classList.toggle("none"),i.classList.toggle("none"),document.querySelectorAll(".thought__item").forEach((t=>{t.classList.toggle("open"),t.classList.toggle("none")}))})),t}createClockChart(){const t=d("div","clock"),e=d("div","hour"),n=d("div","hour__circle"),s=d("div","minutes"),i=d("div","minutes__circle");e.append(n),s.append(i);const a=d("div","chart");this.chartInst.createChart(a,x,{strokeWidth:14,radius:320}),a.append(e,s);const o=d("div","to-do"),r=this.toDoInst.draw(0);return o.append(r),a.append(o),t.append(a),a.addEventListener("mouseover",(t=>this.showToDo(t))),a.addEventListener("mouseout",(t=>this.showCurrToDo(t))),t}async getFilledPage(){const t=document.createElement("section"),e=this.createFlyingThought(),n=this.createThought(),s=d("div","plan-btn");s.textContent="Plan",s.addEventListener("click",(()=>this.goTo("/plan")));const i=d("div","sign-in");i.textContent="User";const a=this.createClockChart();return t.append(e,n,i,s,a),setTimeout((()=>this.clockInst.getTime())),t}},S=class{constructor(t,e){this.type=t,this.input=this.createInput(),this.errorBlock=this.createErrorBlock(),this.input.setAttribute("placeholder",e),this.errorText="Wrong value"}blurCheck(){this.input.value=this.input.value.trim();const t=this.isValueValid(this.input.value);return t||this.showError(),t}isValueValid(t){return!!t}inputCheck(){this.input.value=this.getCorrectValue(this.input.value),this.hideError()}getCorrectValue(t){return t}showError(t){this.errorBlock.innerHTML=this.errorText,t&&(this.errorBlock.innerHTML=t),this.errorBlock.classList.add("sign-form__input-error_active")}hideError(){this.errorBlock.classList.remove("sign-form__input-error_active")}createInput(){const t=document.createElement("input");return t.type=this.type,t.addEventListener("blur",(()=>this.blurCheck())),t.addEventListener("input",(()=>this.inputCheck())),t}createErrorBlock(){const t=document.createElement("span");return t.classList.add("sign-form__input-error"),t}draw(t,...e){this.input.classList.add("sign-form__input");const n=document.createElement("div");return n.classList.add("sign-form__input-box"),t&&n.classList.add(t),e.length>0&&e.forEach((t=>{this.input.classList.add(t)})),n.append(this.input,this.errorBlock),n}},C=class extends S{constructor(t){super("email",t),this.errorText="this is not email"}isValueValid(t){return/^[\w-.]+@[\w-]+\.[a-z]{2,4}$/i.test(t)}getCorrectValue(t){return t.slice(0,200)}},F=class extends S{constructor(t){super("text",t),this.maxValue=50,this.minValue=2,this.errorText="from 2 to 50 characters"}isValueValid(t){return t.length>=this.minValue&&t.length<=this.maxValue}getCorrectValue(t){return t.slice(0,this.maxValue)}},B=class extends S{constructor(t){super("password",t),this.errorText="from 4 characters",this.minValue=4}isValueValid(t){return t.length>=this.minValue}},H=class extends S{constructor(t,e){super("password",t),this.firstPass=e,this.errorText="password mismatch"}isValueValid(t){return t===this.firstPass.input.value}},A=class extends L{constructor(t,e){super("Login page",t,e),this.layout=new class{makeEmptyForm(){const t=document.createElement("div");return t.classList.add("sign-form","sign-form_sign-in"),t}makeTitle(t,e){const n=document.createElement("h1");return n.classList.add("sign-form__title",e),n.innerHTML=t,n}makeButton(){const t=document.createElement("button");t.classList.add("button","button_signIn","sign-form__button");const e=document.createElement("span");e.classList.add("sign-form__button-text","sign-in-view"),e.innerText="Sign In";const n=document.createElement("span");return n.classList.add("sign-form__button-text","sign-up-view"),n.innerText="Sign Up",t.append(e,n),t}makeCheckbox(){const t=document.createElement("input");return t.type="checkbox",t.id="rememberMe",t}makeLabel(){const t=document.createElement("label");t.setAttribute("for","rememberMe"),t.classList.add("sign-form__label","sign-in-view");const e=document.createElement("div");e.classList.add("sign-form__big-o");const n=document.createElement("div");n.classList.add("sign-form__small-o"),e.append(n);const s=document.createElement("span");return s.innerHTML="Remember me",t.append(e,s),t}},this.status="Sign In",this.nameInput=new F("Name"),this.firstPasswordInput=new B("Password"),this.secondPasswordInput=new H("Repeat password",this.firstPasswordInput),this.emailInput=new C("Email"),this.signButton=this.setLoginButton(this.layout.makeButton()),this.checkbox=this.layout.makeCheckbox()}isFormValid(){const t=this.emailInput.blurCheck(),e=this.firstPasswordInput.blurCheck();if("Sign In"===this.status)return t&&e;const n=this.nameInput.blurCheck(),s=this.secondPasswordInput.blurCheck();return t&&e&&n&&s}async sendForm(){const t=this.nameInput.input.value,e=this.emailInput.input.value,n=this.firstPasswordInput.input.value,s=this.checkbox.checked;return"Sign In"===this.status?f.login({email:e,password:n,remember:s}):f.registration({name:t,email:e,password:n})}toggleFormClass(){const t=l("sign-form");t.classList.toggle("sign-form_sign-up"),t.classList.toggle("sign-form_sign-in")}toggleStatus(){switch(this.status){case"Sign In":this.status="Sign Up";break;case"Sign Up":this.status="Sign In"}}errorHandle(t){if("Sign In"===this.status)switch(t.message){case"404":this.emailInput.showError("cant't find this account");break;case"400":this.firstPasswordInput.showError("wrong password");break;default:console.log(t.message)}else"400"===t.message?this.emailInput.showError("this user already exist"):console.log(t.message)}setLoginButton(t){return t.addEventListener("click",(async()=>{if(this.isFormValid())try{p(this.signButton);const t=await this.sendForm();console.log(t),this.cleanForm(),this.status="Sign In",h(this.signButton),this.goTo("/")}catch(t){if(h(this.signButton),!(t instanceof Error))throw t;this.errorHandle(t)}})),t}async getFilledPage(){const t=this.layout.makeEmptyForm();return t.append(this.layout.makeTitle("Sign In","sign-in-view"),this.layout.makeTitle("Sign Up","sign-up-view"),this.nameInput.draw("sign-up-view"),this.emailInput.draw(),this.firstPasswordInput.draw("sign-password"),this.secondPasswordInput.draw("sign-up-view","sign-password"),this.checkbox,this.layout.makeLabel(),this.makeLink("I need a new account","sign-in-view"),this.makeLink("I already have an account","sign-up-view"),this.signButton),t}cleanForm(){this.nameInput.input.value="",this.emailInput.input.value="",this.firstPasswordInput.input.value="",this.secondPasswordInput.input.value=""}cleanErrors(){this.nameInput.hideError(),this.emailInput.hideError(),this.firstPasswordInput.hideError(),this.secondPasswordInput.hideError()}makeLink(t,e){const n=document.createElement("span");return n.innerText=t,n.addEventListener("click",(()=>{this.toggleStatus(),this.toggleFormClass(),this.cleanErrors()})),n.classList.add("sign-form__link",e),n}},W=class extends L{constructor(t,e){super("404 page",t,e)}async getFilledPage(){const t=document.createElement("section");t.classList.add("page-404");const e=document.createElement("h1");e.innerText=this.name,e.classList.add("page-404__title");const n=document.createElement("p");n.innerText="Sorry, didn't find that page...",n.classList.add("page-404__text");const s=document.createElement("button");return s.classList.add("button","button_main"),s.textContent="Home",s.addEventListener("click",(()=>this.goTo("/"))),t.append(e,n,s),t}},R=class{constructor(){this.minTime=15,this.maxTime=15,this.currentTime=15}setTimer(t,e,n){this.minTime=t>15?t:15,this.maxTime=e,this.currentTime=n||this.minTime}makeSlider(){const t=c("input","time-container__slider");return t.type="range",t.id="time-slider-id",t.min=this.minTime.toString(),t.max=this.maxTime.toString(),t.value=this.currentTime.toString(),t}makeHoursInput(t){const e=c("input","time-container__time-input");return e.id=t,e.type="number",e}setTimeInterval(t,e,n){var s;t.value=(s=Number(n),Math.floor(s/60)).toString(),e.value=function(t){return(t%60).toString().padStart(2,"0")}(Number(n)).toString(),this.currentTime=Number(n)}setCorrectTimeInterval(t,e){const n=60*Number(t.value)+Number(e.value);console.log(n),n>this.maxTime&&this.setTimeInterval(t,e,this.maxTime),n<this.minTime&&this.setTimeInterval(t,e,this.minTime)}setSlider(t,e,n){const s=60*Number(e.value)+Number(n.value);t.value=s.toString(),this.currentTime=s}addListeners(t,e,n){return this.setTimeInterval(t,e,n.value),n.addEventListener("input",(()=>this.setTimeInterval(t,e,n.value))),t.addEventListener("input",(()=>{t.value=t.value.replace(/\D+/g,""),t.value.length>1&&"0"===t.value[0]&&(t.value=t.value.substring(1)),this.setSlider(n,t,e)})),e.addEventListener("input",(()=>{e.value=e.value.replace(/\D+/g,""),e.value=e.value.slice(0,2),Number(e.value)>59&&(e.value="59"),this.setSlider(n,t,e)})),t.addEventListener("blur",(()=>{this.setCorrectTimeInterval(t,e),""===t.value&&(t.value="0")})),e.addEventListener("blur",(()=>{e.value=e.value.padStart(2,"0"),this.setCorrectTimeInterval(t,e)})),{hours:t,minutes:e,slider:n}}makeLabel(t,e){const n=c("label","time-container__time-label");return n.htmlFor=e,n.innerText=t,n}weekHoursToDay(){return g(Math.floor(this.currentTime/7))}makePerSection(t,e,n,s){const i=c("span","time-container__per");if(0===s||1===s){const s=c("span","time-container__per-val");e.addEventListener("blur",(()=>{s.innerHTML=this.weekHoursToDay()})),t.addEventListener("blur",(()=>{s.innerHTML=this.weekHoursToDay()})),n.addEventListener("input",(()=>{s.innerHTML=this.weekHoursToDay()})),s.innerHTML=this.weekHoursToDay(),i.append("( ~ ",s,"/day)")}return 4!==s&&3!==s||(i.innerHTML="per day"),i}draw(t){const e=c("div","time-container"),{hours:n,minutes:s,slider:i}=this.addListeners(this.makeHoursInput("Hours"),this.makeHoursInput("Minutes"),this.makeSlider());return e.append(n,this.makeLabel("Hours","hours-input-id"),s,this.makeLabel("Minutes","minutes-input-id"),this.makePerSection(n,s,i,t),i),e}},$={_id:"",color:"#9F5454",title:"Plan for ...",text:"- Make some awesome things",duration:15},N=function(t,e){return`<?xml version="1.0" encoding="utf-8"?>\x3c!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools --\x3e <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" class="${e}" viewBox="0 0 24 24" fill="none" stroke=${t} stroke-width="2" stroke-linecap="round" stroke-linejoin="round" > <path d="M22 11.08V12a10 10 0 11-5.93-9.14" /> <polyline points="22 4 12 14.01 9 11.01" /> </svg>`},V=class extends L{constructor(t,e,n){super("Plan page",t,n),this.popup=e,this.allPlans=[],this.planRounds=[],this.allPlansDist={},this.weekDistribution=[[]],this.layout=new k(t),this.fillWeekTime=0,this.addDayListener=this.addDayListener.bind(this)}isFreeTimeInWeek(){return 10080-this.fillWeekTime>=15}ifFreeTimeInDay(t){return t>=15}getFreeDayMinutes(t){return 1440-this.weekDistribution[Number(t)].reduce(((t,e)=>t+e.duration),0)}getFreePlanMinutes(t){return t.duration-(this.allPlansDist[t._id]||0)}ifFreeTimeInPlan(t){return t>=15}getPlan(t){return this.allPlans.filter((e=>e._id===t))[0]}getCurrentDay(t){const{currentTarget:e}=t;if(!(e instanceof HTMLElement))throw new Error("Ups! This element is not found!");return e}getDragId(){const t=l("plan-round_drag").dataset.planId;if(t)return t;throw new Error("no id")}setPushPlanData(t,e,n){return{dayOfWeek:Number(e),planId:t._id,duration:n.currentTime}}async pushPlanToThisDay(t,e,n,s){const i=this.setPushPlanData(e,n,s),{currentTarget:a}=t;if(!(a instanceof HTMLButtonElement))throw new Error("Ups! This element is not button!");p(a),this.popup.editorModeOff();try{this.popup.easyClose(),l("main__container").classList.add("main__container_hide"),await f.pushPlanToDay(i),this.goTo("/plan")}catch(t){t instanceof Error&&"401"===t.message&&this.goTo("/login")}}makeSliderForDay(t,e,n,s){const i=c("div","slider-popup"),a=y.get(e.color);i.style.background=e.color;const o=document.createElement("button");o.classList.add("editor__button"),a&&(i.style.color=a,o.innerHTML=N(a,"editor__save-icon"));const r=new R;return r.setTimer(15,Math.min(n,s)),o.addEventListener("click",(async n=>this.pushPlanToThisDay(n,e,t,r))),i.append(r.draw(),o),i}addListenersToAllDays(t){document.querySelectorAll(".plan__day").forEach((e=>{e instanceof HTMLElement&&t(e)}))}addDayListener(t){t.addEventListener("dragover",(function(t){t.preventDefault(),this.classList.add("plan__day_over")})),t.addEventListener("dragleave",(function(){this.classList.remove("plan__day_over")})),t.addEventListener("drop",(async t=>{t.stopPropagation(),t.preventDefault();const e=this.getCurrentDay(t);e.classList.remove("plan__day_over");const n=e.dataset.dayId,s=this.getDragId();if(!n||!s)throw new Error("no id");const i=this.getPlan(s),a=this.getFreeDayMinutes(n),o=this.getFreePlanMinutes(i);this.popup.editorMode(),this.ifFreeTimeInDay(a)?this.ifFreeTimeInPlan(o)?this.popup.open(this.makeSliderForDay(n,i,a,o)):this.popup.open(this.layout.makeBanner("This plan is fully distributed")):this.popup.open(this.layout.makeBanner("Less than 15 minutes left\n\n Free up your WEEK time"))}))}setAddButton(){l("plan__button-add").addEventListener("click",(()=>{this.isFreeTimeInWeek()?this.editor.open(15,10080-this.fillWeekTime,0):(this.popup.editorMode(),this.popup.open(this.layout.makeBanner("Less than 15 minutes left\n\n Free up your WEEK time")))}))}makePlans(){this.planRounds=[],this.planRounds=this.allPlans.map((t=>new T(t)))}setPlanDistTime(){const t=this.weekDistribution.flat();this.allPlansDist=t.reduce(((t,e)=>(t[e._id]?t[e._id]+=e.duration:t[e._id]=e.duration,t)),{})}showElements(){const t="scale(1)";setTimeout((()=>{l("plan__button-add").style.transform=t,l("plan__remove").style.transform=t,l("plan__week-line").childNodes.forEach((e=>{e instanceof HTMLDivElement&&(e.style.transform=t)})),document.querySelectorAll(".plan-round").forEach((e=>{e instanceof HTMLDivElement&&(e.style.transform=t)})),document.querySelectorAll(".plan__day-line").forEach((e=>{e instanceof HTMLDivElement&&e.childNodes.forEach((e=>{e instanceof HTMLDivElement&&(e.style.transform=t)}))}))}),0)}fillPlansFields(){const t=l("weekend-fields__big"),e=l("weekend-fields__small"),n=.5*t.clientWidth;this.planRounds.forEach(((s,i)=>{const a=s.planInfo.duration/4110;let o=(n-70)*a+70;o<70&&(o=70),o>n&&(o=n),s.setWidth(o);const r=this.addRoundListener(s);(i%2==0?t:e).append(r)}))}addRoundListener(t){const e=this.allPlansDist[t.planInfo._id]||0,n=t.draw();t.paintRound(e),n.addEventListener("click",(()=>{this.editor.open(e,t.planInfo.duration+10080-this.fillWeekTime,1,t.planInfo)}));const s=l("plan__days"),i=l("plan__remove");return n.addEventListener("dragstart",(function(){setTimeout((()=>{this.classList.add("plan-round_drag"),i.classList.add("plan__remove_drag"),s.classList.add("plan__days_drag"),i.style.transform="scale(1.45)"}),50)})),n.addEventListener("dragend",(function(){this.classList.remove("plan-round_drag"),i.classList.remove("plan__remove_drag"),s.classList.remove("plan__days_drag"),i.style.transform="scale(1)"})),n}fillDays(){document.querySelectorAll(".plan__day").forEach(((t,e)=>{if(t.firstChild instanceof HTMLElement){const n=m(this.weekDistribution[e]),s=this.fillLine(t.firstChild,n,1440,!0);t.lastChild instanceof HTMLElement&&(t.lastChild.innerHTML=g(1440-s))}}))}fillLine(t,e,n,s){t.innerHTML="";const i=(s?t.clientHeight:t.clientWidth)/n;return e.reduce(((e,n)=>{const a=document.createElement("div");return a.style.height=s?n.duration*i+"px":"100%",a.style.width=s?"100%":n.duration*i+"px",a.style.backgroundColor=n.color,t.append(a),e+n.duration}),0)}fillWeekLine(){const t=l("plan__week-line"),e=m(this.allPlans),n=this.fillLine(t,e,10080,!1);this.fillWeekTime=n,l("plan__text-value").innerText=g(n),l("plan__button-add-value").innerText=g(10080-n)}async setWeekInfo(){const t=await Promise.all([f.getAllPlans(),f.getWeekDistribution()]);[this.allPlans,this.weekDistribution]=t}async getFilledPage(){await this.setWeekInfo(),this.makePlans();const t=c("section","plan");return t.append(this.layout.makeNavButton("Home","/",this.goTo),this.layout.makeInfoText(" / 168 h"),this.layout.makeWeekLine(),this.layout.makePlanBody()),t}async draw(){try{const t=l("main__container");await this.animatedFilledPageAppend(t),this.fillWeekLine(),this.setPlanDistTime(),this.fillPlansFields(),this.fillDays(),this.showElements(),this.setAddButton(),this.addListenersToAllDays(this.addDayListener)}catch(t){this.goTo("/login")}}};class q{constructor(t){this.editor=new class{constructor(t,e){this.dayId="",this.oldDur=0,this.goTo=e,this.mode=0,this.popup=t,this.plan={...$},this.open=this.open.bind(this),this.slider=new R,this.saveToLocalStorage=this.saveToLocalStorage.bind(this),this.sendPlan=this.sendPlan.bind(this)}open(t,e,n,s,i){switch(this.mode=n,this.dayId="",this.slider.setTimer(t,e,s?.duration),this.mode){case 1:s&&(this.plan={...s}),this.popup.editorMode();break;case 3:s&&(this.plan={...s}),s&&(this.oldDur={...s}.duration),i&&(this.dayId=i),this.popup.editorMode();break;case 0:this.popup.editorMode(this.saveToLocalStorage),this.loadToLocalStorage();break;case 4:i&&(this.dayId=i),this.popup.editorMode(this.saveToLocalStorage),this.loadToLocalStorage()}this.drawEditor()}loadToLocalStorage(){const t=localStorage.getItem(`new-plan-save/${this.dayId}`);t?this.plan=JSON.parse(t):(this.plan={...$},this.plan.color=this.getRandomColor())}async sendPlan(){this.setPlan();const{_id:t,title:e,text:n,color:s,duration:i}=this.plan,a={dayOfWeek:Number(this.dayId),planId:this.plan._id,duration:this.plan.duration-this.oldDur};switch(this.mode){case 0:await f.createNewPlan({title:e,text:n,color:s,duration:i}),localStorage.removeItem(`new-plan-save/${this.dayId}`);break;case 1:await f.editPlan({_id:t,title:e,text:n,color:s,duration:i});break;case 3:await f.editPlan({_id:t,title:e,text:n,color:s}),await f.pushPlanToDay(a);break;case 4:const o=await f.createNewPlan({title:e,text:n,color:s,duration:i});await f.pushPlanToDay({dayOfWeek:Number(this.dayId),planId:o._id,duration:o.duration}),localStorage.removeItem(`new-plan-save/${this.dayId}`)}}saveToLocalStorage(){this.setPlan(),localStorage.setItem(`new-plan-save/${this.dayId}`,JSON.stringify(this.plan))}setPlan(){this.plan.duration=this.slider.currentTime,this.plan.title=function(t,e=document){const n=e.querySelector(t);if(null===n)throw new Error("Ups! This element is not found!");if(!(n instanceof HTMLInputElement))throw new Error("Ups! This element is not input!");return n}(".editor__title").value;const t=document.querySelector(".editor__text");t instanceof HTMLTextAreaElement&&(this.plan.text=t.value)}getRandomColor(){const t=y.size,e=Math.floor(Math.random()*t),n=[];return y.forEach(((t,e)=>{n.push(e)})),n[e]}drawEditor(){const t=y.get(this.plan.color);if(!t)throw new Error("This color is not standard");const e=this.makeContainer(t),n=c("div","editor__tools");n.append(this.makeAcceptButton(t),this.colorPicker(),this.makeColorBox(),this.slider.draw(this.mode)),e.append(n,this.makeTitle(),this.makeText()),this.popup.open(e)}makeContainer(t){const e=c("div","editor");return e.style.backgroundColor=this.plan.color,e.style.color=t,e}makeTitle(){const t=document.createElement("input");return t.classList.add("editor__title"),t.value=this.plan.title,t.addEventListener("blur",(function(){this.value=this.value.trim()})),t.addEventListener("blur",(t=>{const{target:e}=t;e instanceof HTMLInputElement&&""===e.value&&(e.value="Plan for ...")})),t.addEventListener("focus",(t=>{const{target:e}=t;e instanceof HTMLInputElement&&"Plan for ..."===e.value&&(e.value="")})),t}makeText(){const t=document.createElement("textarea");return t.classList.add("editor__text"),t.value=this.plan.text,t}makeAcceptButton(t){const e=document.createElement("button");return e.classList.add("editor__button"),e.innerHTML=N(t,"editor__save-icon"),e.addEventListener("click",(async t=>{const{currentTarget:e}=t;if(!(e instanceof HTMLButtonElement))throw new Error("Ups! This element is not button!");p(e);try{this.popup.easyClose(),l("main__container").classList.add("main__container_hide"),await this.sendPlan(),this.goTo(this.dayId?`/${o[Number(this.dayId)]}`:"/plan")}catch(t){_(t,this.goTo)}})),e}colorPicker(){const t=c("div","editor__color-picker");return t.addEventListener("click",(()=>this.toggleColorBox())),t}makeColorBox(){const t=c("div","editor__color-box");return y.forEach(((e,n)=>{t.append(this.makeColorRound(n))})),t}makeColorRound(t){const e=c("div","editor__color-round");return e.style.backgroundColor=t,e.setAttribute("data-picker-color",t),e.addEventListener("click",(()=>this.toggleColorBox())),e.addEventListener("click",(t=>this.changeColor(t))),e}changeColor(t){const{target:e}=t;if(e instanceof HTMLElement){const t=e.dataset.pickerColor;t&&(this.plan.color=t,this.paintEditor(t))}}paintEditor(t){const e=l("editor");e.style.backgroundColor=t;const n=y.get(t);n&&(e.style.color=n,l("editor__save-icon").style.stroke=n)}toggleColorBox(){l("editor__color-box").classList.toggle("editor__color-box_active")}}(t,this.goTo),q.homePage=new M(this.goTo,this.editor),q.planPage=new V(this.goTo,t,this.editor),q.loginPage=new A(this.goTo,this.editor),q.dayPage=new b(this.goTo,t,this.editor),q.notFoundPage=new W(this.goTo,this.editor)}static async render(t){switch(t){case"/plan":await q.planPage.draw();break;case"/login":await q.loginPage.draw();break;case"/":await q.homePage.draw();break;default:v(t)?q.dayPage.draw(v(t)):q.notFoundPage.draw()}}goTo(t){window.history.pushState({pageName:t},t,t),q.render(t),window.scrollTo(0,0)}async startRouter(){window.addEventListener("popstate",(()=>{q.render(new URL(window.location.href).pathname)}));const t=new URL(window.location.href).pathname;await q.render(t)}}var U=q;(new class{constructor(){this.popup=new class{constructor(){this.popup=l("popup")}editorMode(t){const e=n=>this.close(n,e,t);this.popup.addEventListener("click",e)}editorModeOff(t){const e=n=>this.close(n,e,t);this.popup.removeEventListener("click",e)}close(t,e,n){const{target:s}=t;s instanceof HTMLElement&&(s.classList.contains("popup")&&(n&&n(),this.clean(s),this.popup.removeEventListener("click",e)),s.closest(".editor__button")&&this.popup.removeEventListener("click",e)),s instanceof SVGElement&&s.closest(".editor__button")&&this.popup.removeEventListener("click",e)}easyClose(){this.clean(this.popup)}clean(t){t.addEventListener("transitionend",(function(){t.innerHTML=""}),{once:!0}),t.classList.remove("popup_show")}open(t){this.popup.append(t),setTimeout((()=>{this.popup.classList.add("popup_show")}),0)}},this.router=new U(this.popup)}start(){this.router.startRouter()}}).start()}()}();